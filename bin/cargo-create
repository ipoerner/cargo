#!/bin/sh

set -e

SCRIPT=$(readlink -f "$0")
SCRIPTPATH=$(dirname "$SCRIPT")

case $# in
    1)
    BASE=${1}
    IMAGE_NAME="cargo/base-${BASE}"
    ;;
    *)
    echo "Usage: cargo-create <base-image>"
    exit 1
    ;;
esac

cp -f ${SCRIPTPATH}/../base/Dockerfile.${BASE} ${SCRIPTPATH}/../base/Dockerfile
sudo docker build \
    --tag ${IMAGE_NAME} \
    --force-rm \
    ${SCRIPTPATH}/../base/
rm ${SCRIPTPATH}/../base/Dockerfile
